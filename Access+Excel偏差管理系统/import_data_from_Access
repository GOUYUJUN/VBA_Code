Sub 导入Access数据()

    ' 声明变量
    Dim db As Object   ' Access 数据库
    Dim tb As Object   ' Access 记录集
    Dim wb As Object   ' Excel 工作簿
    Dim ws As Object   ' Excel 工作表
    Dim tbNames As Variant   ' Access 表名数组
    Dim tbName As Variant   ' Access 表名
    
    ' 打开 Access 数据库
    Set db = CreateObject("DAO.DBEngine.120").OpenDatabase("C:\Users\GOUYU\Desktop\QC实验室管理系统by苟育军V7.accdb")
    
    ' 获取已经打开的 Excel 工作簿
    Set wb = CreateObject("Excel.Application").ActiveWorkbook
    
    ' 声明要抓取的 Access 表名数组
    tbNames = Array("Events", "SSF", "OOX", "偏差", "选项信息")
    
    ' 遍历需要抓取的 Access 表
    For Each tbName In tbNames
    
        ' 找到相应的 Excel 工作表，如果找不到则创建一个新的工作表
        On Error Resume Next
        Set ws = wb.Sheets(tbName)
        If ws Is Nothing Then
            Set ws = wb.Sheets.Add(After:=wb.Sheets(wb.Sheets.Count))
            ws.Name = tbName
        End If
        On Error GoTo 0
        
        ' 清空目标工作表的内容
         
        Sheets(tbName).Range("A1:Z100000").CurrentRegion.Clear
        
        ' 打开 Access 记录集
        Set tb = db.OpenRecordset("SELECT * FROM [" & tbName & "];")
        
        ' 将 Access 记录集数据导入 Excel 工作表
        Sheets(tbName).Range("A1").CopyFromRecordset tb
        
        ' 设置单元格格式
        
    Next tbName
    
    ' 关闭 Access 数据库
    db.Close
    
    ' 释放内存
    Set db = Nothing
    Set wb = Nothing
    Set ws = Nothing
End Sub




