'promote
'写一段VBA代码，实现从路径"C:\Users\GOUYU\Desktop\QC实验室管理系统by苟育军V7.accdb"的ACCESS数据库中
'将表“Events","SSF","OOX","偏差"中的数据全部抓取到"C:\Users\GOUYU\Desktop\偏差分析系统.xlsx"的EXCEL工作簿中
'的工作表sheet “Events","SSF","OOX","偏差"中。要求表头也需要抓取，并且设置筛选，所有数据居中左对齐，并取消自动换行。
' 将 Access 表中的数据导入 Excel 表中，并设置格式
Sub 导入Access数据()

    ' 声明变量
    Dim db As Object   ' Access 数据库
    Dim tb As Object   ' Access 记录集
    Dim wb As Object   ' Excel 工作簿
    Dim ws As Object   ' Excel 工作表
    Dim tbNames As Variant   ' Access 表名数组
    Dim tbName As Variant   ' Access 表名
    
    ' 打开 Access 数据库
    Set db = CreateObject("DAO.DBEngine.120").OpenDatabase("C:\Users\GOUYU\Desktop\QC实验室管理系统by苟育军V7.accdb")
    
    ' 打开 Excel 工作簿
    Set wb = CreateObject("Excel.Application").Workbooks.Open("C:\Users\GOUYU\Desktop\偏差分析系统.xlsx")
    
    ' 声明要抓取的 Access 表名数组
    tbNames = Array("Events", "SSF", "OOX", "偏差")
    
    ' 遍历需要抓取的 Access 表
    For Each tbName In tbNames
    
        ' 找到相应的 Excel 工作表，并清空目标工作表的内容
        Set ws = wb.Sheets(tbName)
        ws.Range("A1").CurrentRegion.Clear
        
        ' 打开 Access 记录集
        Set tb = db.OpenRecordset("SELECT * FROM [" & tbName & "];")
        
        ' 将 Access 记录集数据导入 Excel 工作表
        ws.Range("A1").CopyFromRecordset tb
        
        ' 设置单元格格式
        ws.Cells.HorizontalAlignment = xlCenter
        ws.Cells.VerticalAlignment = xlCenter
        ws.Cells.EntireColumn.AutoFit
        ws.Cells.WrapText = False
    Next tbName
    
    ' 关闭 Excel 工作簿
    wb.Close SaveChanges:=True
    
    ' 关闭 Access 数据库
    db.Close
    
    ' 释放内存
    Set db = Nothing
    Set wb = Nothing
    Set ws = Nothing

End Sub






